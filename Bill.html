<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMW | Premium Wide Billing</title>
    <style>
        :root { --gold-primary: #b8962d; --bg-soft: #f8fafc; --text-dark: #1e293b; }
        
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: #e2e8f0; margin: 0; padding: 20px; color: var(--text-dark); }
        
        /* wide screen setup */
        .bill-container { 
            width: 98%; 
            max-width: 1300px; 
            margin: auto; 
            background: white; 
            padding: 40px; 
            border-radius: 8px; 
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-top: 12px solid var(--gold-primary);
            position: relative;
        }

        /* Branding */
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #f1f5f9; padding-bottom: 20px; margin-bottom: 30px; }
        .shop-name h1 { margin: 0; font-size: 32px; letter-spacing: 2px; color: var(--gold-primary); text-transform: uppercase; }
        .invoice-label { text-align: right; }
        .invoice-label h2 { margin: 0; color: #64748b; font-size: 18px; }

        /* horizontal grid for inputs */
        .input-box { background: var(--bg-soft); padding: 20px; border-radius: 10px; border: 1px solid #e2e8f0; margin-bottom: 25px; }
        .grid-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px; }
        
        label { display: block; font-size: 11px; font-weight: 700; color: #475569; margin-bottom: 5px; text-transform: uppercase; }
        input, select { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 14px; background: white; }
        input:focus { border-color: var(--gold-primary); outline: none; box-shadow: 0 0 0 2px rgba(184, 150, 45, 0.1); }

        /* Table */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background: #334155; color: white; padding: 15px; text-align: left; font-size: 13px; }
        td { padding: 15px; border-bottom: 1px solid #f1f5f9; font-size: 14px; }

        /* Old Gold Style */
        #oldGoldModule { display: none; background: #fff1f2; border: 1px solid #fecaca; padding: 20px; border-radius: 10px; margin-top: 20px; }

        /* Footer */
        .summary-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 60px; margin-top: 40px; padding-top: 30px; border-top: 2px solid #f1f5f9; }
        .calc-row { display: flex; justify-content: space-between; padding: 10px 0; font-size: 16px; border-bottom: 1px dashed #e2e8f0; }
        .net-total { font-size: 28px; font-weight: 800; color: #166534; background: #f0fdf4; padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #bbf7d0; }

        .btn { cursor: pointer; border: none; font-weight: 700; padding: 12px 24px; border-radius: 6px; color: white; transition: 0.2s; }
        .btn-add { background: var(--gold-primary); width: 100%; margin-top: 10px; }
        .btn-pdf { background: #0f172a; width: 100%; margin-top: 20px; font-size: 16px; }

        .print-text { display: none; font-weight: bold; }

        @media print {
            body { background: white; padding: 0; }
            .bill-container { width: 100%; box-shadow: none; border: 2px solid #eee; padding: 20px; }
            .no-print { display: none !important; }
            .print-text { display: inline-block; }
            input, select { border: none; background: transparent; }
            #oldGoldModule { display: block !important; }
        }
    </style>
</head>
<body>

<div class="bill-container">
    <div class="header">
        <div class="shop-name">
            <h1>Smm</h1>
            <p style="margin:5px 0; color:#64748b;">நம்பிக்கை நாணயம் கைராசி </p>
        </div>
        <div class="invoice-label">
            <h2>no:9865739322</h2>
            <p>Date: <span id="curDate"></span></p>
        </div>
    </div>

    <div class="input-box no-print">
        <div class="grid-row">
            <div><label>Customer Name</label><input type="text" id="custName" placeholder="Name"></div>
            <div><label>Phone Number</label><input type="text" id="custPhone" placeholder="Mobile"></div>
            <div><label>24K Gold Rate (10g)</label><input type="number" id="marketRate" value="79000"></div>
            <div><label>Payment Mode</label>
                <select id="payMode">
                    <option>CASH</option><option>UPI / G-PAY</option><option>CREDIT CARD</option>
                </select>
            </div>
        </div>
    </div>

    <div class="input-box no-print">
        <label style="color:var(--gold-primary); margin-bottom:15px;">Add New Purchase Item</label>
        <div class="grid-row">
            <input type="text" id="itemName" placeholder="Item (e.g. Chain)">
            <select id="purity"><option value="0.916">22K (916)</option><option value="1.0">24K</option><option value="0.75">18K</option></select>
            <input type="number" id="weight" placeholder="Weight (g)">
            <input type="number" id="wastage" placeholder="Wastage %">
            <input type="number" id="stone" placeholder="Stone ₹">
            <input type="number" id="hallmark" placeholder="Hallmark ₹">
            <input type="number" id="making" placeholder="Making ₹">
        </div>
        <button class="btn btn-add" onclick="addRow()">+ ADD ITEM TO TABLE</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>PURITY</th>
                <th>GROSS WEIGHT</th>
                <th>WASTAGE (%)</th>
                <th>ADDL. CHARGES</th>
                <th>TOTAL AMOUNT</th>
            </tr>
        </thead>
        <tbody id="billTable"></tbody>
    </table>

    <div class="no-print" style="margin: 20px 0;">
        <label style="display:inline; margin-right: 10px;">Customer Giving Old Gold?</label>
        <button class="btn" style="background:#64748b; padding: 5px 15px;" onclick="toggleOG(true)">YES</button>
        <button class="btn" style="background:#cbd5e1; color:#333; padding: 5px 15px;" onclick="toggleOG(false)">NO</button>
    </div>

    <div id="oldGoldModule">
        <label style="color:#b91c1c; font-weight:bold; margin-bottom:10px;">OLD GOLD EXCHANGE DETAILS</label>
        <div class="grid-row no-print">
            <div><label>Old Weight (g)</label><input type="number" id="ogWt" oninput="calculateOG()"></div>
            <div><label>Old Wastage (g)</label><input type="number" id="ogWaste" value="0" oninput="calculateOG()"></div>
            <div><label>Touch (Purity %)</label><input type="number" id="ogTouch" value="92" oninput="calculateOG()"></div>
            <div><label>Exchange Rate (per g)</label><input type="number" id="ogRate" oninput="calculateOG()"></div>
        </div>
        <p style="font-weight: bold; color: #b91c1c; margin-top: 10px;">Exchange Credit Value: ₹ <span id="ogValueDisp">0.00</span></p>
    </div>

    <div class="summary-grid">
        <div style="font-size: 13px;">
            <p><strong>Customer:</strong> <span class="print-text" id="pName"></span></p>
            <p><strong>Phone:</strong> <span class="print-text" id="pPhone"></span></p>
            <p><strong>Payment Mode:</strong> <span class="print-text" id="pMode"></span></p>
            <div style="margin-top: 60px; border-top: 1px solid #333; width: 200px; text-align: center; padding-top: 5px;">Authorized Signature</div>
        </div>
        <div>
            <div class="calc-row"><span>Purchase Total:</span> <span>₹ <span id="subTotal">0.00</span></span></div>
            <div class="calc-row" style="color: #b91c1c;"><span>Old Gold Exchange:</span> <span>- ₹ <span id="ogFinal">0.00</span></span></div>
            <div class="calc-row"><span>Advance Paid:</span> <input type="number" id="advInp" class="no-print" value="0" oninput="updateFinal()" style="width: 100px; text-align: right;"></div>
            <div class="net-total">
                <span style="font-size: 14px;">NET AMOUNT:</span>
                <span style="float: right;">₹ <span id="netTotal">0.00</span></span>
            </div>
            <button class="btn btn-pdf no-print" onclick="printInvoice()">DOWNLOAD PDF / PRINT</button>
        </div>
    </div>
</div>

<script>
    let grandPurchase = 0;
    let exchangeVal = 0;
    document.getElementById('curDate').innerText = new Date().toLocaleDateString('en-IN');

    function toggleOG(val) {
        document.getElementById('oldGoldModule').style.display = val ? 'block' : 'none';
        if(!val) { exchangeVal = 0; updateFinal(); }
    }

    function addRow() {
        const item = document.getElementById('itemName').value;
        const wt = parseFloat(document.getElementById('weight').value);
        const wastePer = parseFloat(document.getElementById('wastage').value || 0);
        const stone = parseFloat(document.getElementById('stone').value || 0);
        const hallmark = parseFloat(document.getElementById('hallmark').value || 0);
        const making = parseFloat(document.getElementById('making').value || 0);
        const rate = parseFloat(document.getElementById('marketRate').value) / 10;
        const purity = parseFloat(document.getElementById('purity').value);

        if(!item || !wt) return alert("Please fill Item Name and Weight");

        const finalWt = wt + (wt * wastePer / 100);
        const itemTotal = (finalWt * rate * purity) + stone + hallmark + making;

        const row = `<tr>
            <td><strong>${item}</strong></td>
            <td>${document.getElementById('purity').options[document.getElementById('purity').selectedIndex].text}</td>
            <td>${finalWt.toFixed(3)}g</td>
            <td>${wastePer}%</td>
            <td>₹${(stone + hallmark + making).toLocaleString()}</td>
            <td><strong>₹${itemTotal.toLocaleString('en-IN', {minimumFractionDigits: 2})}</strong></td>
        </tr>`;

        document.getElementById('billTable').innerHTML += row;
        grandPurchase += itemTotal;
        updateFinal();

        // Clear Item Inputs
        document.getElementById('itemName').value = '';
        document.getElementById('weight').value = '';
        document.getElementById('stone').value = '0';
        document.getElementById('hallmark').value = '0';
        document.getElementById('making').value = '0';
    }

    function calculateOG() {
        const wt = parseFloat(document.getElementById('ogWt').value || 0);
        const waste = parseFloat(document.getElementById('ogWaste').value || 0);
        const touch = parseFloat(document.getElementById('ogTouch').value || 0);
        const rate = parseFloat(document.getElementById('ogRate').value || 0);

        exchangeVal = (wt - waste) * rate * (touch / 100);
        document.getElementById('ogValueDisp').innerText = exchangeVal.toLocaleString('en-IN');
        document.getElementById('ogFinal').innerText = exchangeVal.toLocaleString('en-IN');
        updateFinal();
    }

    function updateFinal() {
        const adv = parseFloat(document.getElementById('advInp').value || 0);
        const net = grandPurchase - exchangeVal - adv;
        
        document.getElementById('subTotal').innerText = grandPurchase.toLocaleString('en-IN', {minimumFractionDigits: 2});
        document.getElementById('netTotal').innerText = net.toLocaleString('en-IN', {minimumFractionDigits: 2});
    }

    function printInvoice() {
        document.getElementById('pName').innerText = document.getElementById('custName').value || "N/A";
        document.getElementById('pPhone').innerText = document.getElementById('custPhone').value || "N/A";
        document.getElementById('pMode').innerText = document.getElementById('payMode').value;
        window.print();
    }
</script>

</body>
</html>
